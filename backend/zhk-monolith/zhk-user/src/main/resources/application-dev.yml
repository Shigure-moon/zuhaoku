spring:
  application:
    name: zhk-user
  
  # HTTP 编码配置
  http:
    encoding:
      charset: UTF-8
      enabled: true
      force: true
  
  # 服务器配置
  server:
    port: 8081  # 开发环境使用 8081，避免端口冲突
    # 注意：不设置 context-path，路径在 Controller 中定义
    servlet:
      encoding:
        charset: UTF-8
        enabled: true
        force: true

  # 数据源配置
  datasource:
    driver-class-name: com.mysql.cj.jdbc.Driver
    # Docker 环境：使用容器服务名 mysql
    # 本地环境：使用 localhost:3307（避免与系统 MySQL 冲突）
    url: jdbc:mysql://${MYSQL_HOST:localhost}:${MYSQL_PORT:3307}/zhk_rental?useUnicode=true&characterEncoding=utf8&serverTimezone=Asia/Shanghai&useSSL=false
    username: ${MYSQL_USER:root}
    password: ${MYSQL_PASSWORD:root123456}
    hikari:
      maximum-pool-size: 20
      minimum-idle: 5
      connection-timeout: 30000
      idle-timeout: 600000
      max-lifetime: 1800000

  # Redis 配置
  data:
    redis:
      # Docker 环境：使用容器服务名 redis
      # 本地环境：使用 localhost:6380（避免与系统 Redis 冲突）
      host: ${REDIS_HOST:localhost}
      port: ${REDIS_PORT:6380}
      password: ${REDIS_PASSWORD:}
      database: 0
      lettuce:
        pool:
          max-active: 8
          max-idle: 8
          min-idle: 0

# MyBatis-Plus 配置
mybatis-plus:
  mapper-locations: classpath*:/mapper/**/*.xml
  # 扫描所有模块的实体类
  type-aliases-package: com.zhk.**.entity
  configuration:
    map-underscore-to-camel-case: true
    log-impl: org.apache.ibatis.logging.stdout.StdOutImpl
    # 确保使用 UTF-8 编码
    default-executor-type: reuse
  global-config:
    db-config:
      id-type: auto
      logic-delete-field: deleted
      logic-delete-value: 1
      logic-not-delete-value: 0

# 应用配置
zhk:
  # JWT 配置
  jwt:
    secret: zhk-rental-core-secret-key-min-256-bits-for-security-please-change-in-production
    expiration: 86400000 # 24小时
  
  # 加密配置
  encryption:
    algorithm: AES
    mode: GCM
    key: zhk-encryption-key-32-bytes-long
    master-key: ZHK-RentalCore-2024-MasterKey-32Bytes!!

  # MinIO 配置（开发环境）
  minio:
    endpoint: http://localhost:9002
    access-key: minioadmin
    secret-key: minioadmin123
    bucket-name: zhk-evidence

  # 支付宝配置（开发环境）
  alipay:
    app-id: 2021006112616763  # Woo租号酷 AppID
    private-key: |
      -----BEGIN PRIVATE KEY-----
      MIIEvgIBADANBgkqhkiG9w0BAQEFAASCBKgwggSkAgEAAoIBAQCjLQcH89cIzvtG
      eoUKwzqsEoMDz2RoH16wRXGUipfTQPOiTITVBtGGCPWbEtgfrtH548+is6LfUXDS
      VywDsYIQrX60RwqjEKuKrU1392nBpa7TvYycj1KUP/AhSFEmMbvD4DX+hRDrc9ms
      3bkl12hqLQV6VCKv1QqSdAq2sQFXjd4CEWer/4EpYS7vRWnO/DmlJAGpEasSVQrR
      ZHZE13ShMcJGOAhqSG4EEOqiVpTV7OKdnXaFu2/Tf0WcDOD76B586LD8FY0G+PgX
      Nqd7/e9lpUPSw/6jXLKVgu+oklQnSHkfTL5OV3HuNoLnaD4gHdwqRsziqkfOO0Nl
      pDlowTrXAgMBAAECggEAJ7L2QXSNLfrxfkmjoaUy2pdcYaps4rozFs6mXf3EB2UH
      gUZ9kLhqdGIsovBYPYkSU+odY5exugQ93ybPMgzXOIiFSYX5LAgLvB8CuHussqzF
      FoXItnRWInRVzzshZxn1dSfQ6x3jqm0SmfCNsYuxPxe5+/OJRt8dhdkOnDj/OxYI
      3FFBRrjciV46+66nYjeHkLsglOisSfn/wrUWzopPkHoXMnwVbsUcXJdR86UWxn3t
      k3wPgoq/BCBzTFLIMviNG4nDIhCe4t8rUVPKvopnBumVj3XiwBExj7c2C+jEkAj4
      D+DAsCzJRQobZi/JNYWuO7S8majmER/2NJ2xtn13DQKBgQDSxyW97Ikz4p/bNfa+
      MISlD3d2XntQsaY/0T7GkmS6TrgHnfk0KFPwMed3UyiDOMKx6g+uiNJdYBFbnm7D
      y6G9BM3IQGiMeSot7YMz9dHNrswp846p7BfZ+oKPnPMn8GWZqrhKq+xIT+/U/CXl
      lV9Sk7uGO03N+xjg9VBZ3m6+bQKBgQDGL13bka9kSd2em+g52bbJghEgxO+F7zJP
      MyiXmGuEYvApQXHAR1dN2/48YBPyjYoS4RwTKsT4TFehQxTQOsV11Zl5MF9dmtYJ
      Kl2ThIxkfB1Sd66cvAW2i3aUvP3zLgHFPza3rfy1VGXWIDEajdQpDhZSR5z1vgEr
      A2Y+YNsD0wKBgQDB945d5wyj+MuPGWwFvfRzSXZwMaZdrf4GAHM6nYGgicyFBfVM
      8Ee+ZM5TWu2PRG6292STA0pDr6KJo5TfDce7gG42+D699srAFTCGYpM+KrurZ31E
      FgYlDImVy6Ngf7Of5CFQZkI8kYNthtUBH6LnBRivAGgrRAWzD01wRme3SQKBgQCM
      RzK0G+Z9ohsQDWLOr9/Fuh7NhxfTQX/mt1tgEi7oQe+kBAK0Csss/S5zJb54zN6S
      hmwM1RUee0r7hjPRQAhMY6iCM08NPm+JhUc/B28oIQHQQY6CukOA9i41EaDe5A20
      xA3C7ZAV+WsrqRWYqhMmDCaYjr/24UqKW5mfRYdAqQKBgB3t36c3Iirno82hLajA
      aa3Rdq9DSXmshr2e34VoCoIcCvO0ErR8bBPVab+QirFxiWX7bhY5QrYciLc5/F8W
      mYAlggZjEDIcXvNHeB6f+EUcW9Or/CJiMlOcFh3vBGBwKU6pBH9zPZLKSCp3ctYx
      gpIYVGM32DOtStNVF+IEmXyB
      -----END PRIVATE KEY-----
    alipay-public-key: |
      -----BEGIN PUBLIC KEY-----
      MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAkAazBMmylpczF95Cnst378nberUZuTFLdx549S/0JFRU7wqfAn91/HIrxJZUJpiKC3xvrkiz4vA4+RSDAGpP5KTyPmfQRuphtn38tquQp08a57l+osx9L0121r5VESwIbDhsmvFsJ9PMr0U7xuVrZk3jDSyTLHaW0kAeh7l8hFumLnK7eFQsiFEOLWnK+0Y02xpuiY9bzCvuR54bFfrtGlYt2yHVG77DWTSj8RjXY0ZziQ19N83yUoKzNjW5FbmO+ZqVDbMLdvAxw8h3+XdMMqOxAAZBl+n7zq/u41USDZZZ3s+KmR6iz7aqQI3ds+4SGh5+PaSaslkApAagPJIXtQIDAQAB
      -----END PUBLIC KEY-----
    gateway-url: https://openapi.alipaydev.com/gateway.do  # 本地开发使用沙箱环境
    # 生产环境: https://openapi.alipay.com/gateway.do
    encrypt-key: lE4SjgSUUKi5tmrfKB3A3g==
    notify-url: http://localhost:8081/api/v1/payments/alipay/notify
    return-url: http://localhost:3000/tenant/orders
    sign-type: RSA2
    charset: UTF-8

  # 禁用 Redisson 自动配置（如果暂时不需要 Redis 功能）
  autoconfigure:
    exclude:
      - org.redisson.spring.starter.RedissonAutoConfiguration
      - org.springframework.boot.actuate.autoconfigure.data.redis.RedisReactiveHealthContributorAutoConfiguration
      - org.springframework.boot.actuate.autoconfigure.data.redis.RedisHealthContributorAutoConfiguration

# 日志配置
logging:
  level:
    com.zhk: DEBUG
    org.springframework.security: DEBUG

